<!DOCTYPE html>
<html>
  <head>
    <title>Craftor</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <style>
:root {
  /* Apple Design System Colors */
  --background-primary: #ffffff;
  --background-secondary: #f5f5f7;
  --background-tertiary: #fbfbfd;
  --label-primary: #1d1d1f;
  --label-secondary: #86868b;
  --label-tertiary: #6e6e73;
  --separator-primary: #d2d2d7;
  --separator-secondary: #e5e5e7;
  --system-blue: #007aff;
  --system-blue-dark: #0051d0;
  --system-gray: #8e8e93;
  --system-gray-light: #f2f2f7;
  --destructive: #ff3b30;
  
  /* Apple Typography */
  --font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Helvetica Neue', Arial, sans-serif;
  --font-family-mono: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, monospace;
  
  /* Apple Spacing System */
  --spacing-xs: 4px;
  --spacing-sm: 8px;
  --spacing-md: 16px;
  --spacing-lg: 24px;
  --spacing-xl: 32px;
  --spacing-2xl: 48px;
  --spacing-3xl: 64px;
  
  /* Apple Border Radius */
  --radius-xs: 4px;
  --radius-sm: 8px;
  --radius-md: 12px;
  --radius-lg: 16px;
  --radius-xl: 24px;
  
  /* Apple Shadows */
  --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.04), 0 1px 2px rgba(0, 0, 0, 0.06);
  --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.05), 0 2px 4px rgba(0, 0, 0, 0.08);
  --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.08), 0 4px 6px rgba(0, 0, 0, 0.05);
  --shadow-xl: 0 20px 25px rgba(0, 0, 0, 0.08), 0 8px 10px rgba(0, 0, 0, 0.04);
  
  /* Apple Transitions */
  --transition-fast: 0.15s cubic-bezier(0.4, 0, 0.2, 1);
  --transition-base: 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  --transition-slow: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

html {
  scroll-behavior: smooth;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

body {
  font-family: var(--font-family);
  background-color: var(--background-tertiary);
  color: var(--label-primary);
  line-height: 1.5;
  font-size: 17px;
  font-weight: 400;
}

/* Apple Typography Scale */
.text-6xl { font-size: 3.75rem; font-weight: 600; line-height: 1; letter-spacing: -0.025em; }
.text-5xl { font-size: 3rem; font-weight: 600; line-height: 1; letter-spacing: -0.025em; }
.text-4xl { font-size: 2.25rem; font-weight: 600; line-height: 1.1; letter-spacing: -0.025em; }
.text-3xl { font-size: 1.875rem; font-weight: 600; line-height: 1.2; letter-spacing: -0.025em; }
.text-2xl { font-size: 1.5rem; font-weight: 600; line-height: 1.3; letter-spacing: -0.025em; }
.text-xl { font-size: 1.25rem; font-weight: 600; line-height: 1.4; }
.text-lg { font-size: 1.125rem; font-weight: 400; line-height: 1.5; }
.text-base { font-size: 1rem; font-weight: 400; line-height: 1.5; }
.text-sm { font-size: 0.875rem; font-weight: 400; line-height: 1.4; }
.text-xs { font-size: 0.75rem; font-weight: 400; line-height: 1.4; }

/* Layout */
.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 var(--spacing-lg);
}

main {
  padding: var(--spacing-2xl) 0 100px 0;
}

/* Header */
.hero {
  text-align: center;
  margin-bottom: var(--spacing-3xl);
  padding: var(--spacing-3xl) 0;
}

.hero-title {
  margin-bottom: var(--spacing-md);
  background: linear-gradient(135deg, var(--label-primary) 0%, var(--system-blue) 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.hero-subtitle {
  color: var(--label-secondary);
  max-width: 640px;
  margin: 0 auto;
}

/* Apple Card Design */
.card {
  background: var(--background-primary);
  border-radius: var(--radius-lg);
  border: 1px solid var(--separator-secondary);
  box-shadow: var(--shadow-md);
  overflow: hidden;
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
}

.card-header {
  padding: var(--spacing-xl);
  border-bottom: 1px solid var(--separator-secondary);
  background: var(--background-secondary);
  display: flex;
  justify-content: space-between;
  align-items: center;
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
}

.card-body {
  padding: var(--spacing-xl);
}

/* Apple Button System */
.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: var(--spacing-sm);
  padding: 12px var(--spacing-lg);
  border-radius: var(--radius-md);
  font-family: inherit;
  font-size: 17px;
  font-weight: 590;
  line-height: 1.2;
  text-decoration: none;
  cursor: pointer;
  transition: all var(--transition-base);
  border: none;
  outline: none;
  position: relative;
  overflow: hidden;
}

.btn::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(135deg, rgba(255, 255, 255, 0.2) 0%, rgba(255, 255, 255, 0) 100%);
  opacity: 0;
  transition: opacity var(--transition-base);
}

.btn:hover::before {
  opacity: 1;
}

.btn-primary {
  background: linear-gradient(135deg, var(--system-blue) 0%, var(--system-blue-dark) 100%);
  color: white;
  box-shadow: var(--shadow-sm);
}

.btn-primary:hover {
  transform: translateY(-1px);
  box-shadow: var(--shadow-md);
}

.btn-secondary {
  background: var(--background-secondary);
  color: var(--label-primary);
  border: 1px solid var(--separator-primary);
}

.btn-secondary:hover {
  background: var(--background-primary);
  border-color: var(--system-blue);
}

.btn-ghost {
  background: rgba(0, 122, 255, 0.08);
  color: var(--system-blue);
  border: 1px solid rgba(0, 122, 255, 0.2);
}

.btn-ghost:hover {
  background: rgba(0, 122, 255, 0.12);
  border-color: var(--system-blue);
}

.btn-sm {
  padding: 8px var(--spacing-md);
  font-size: 15px;
  border-radius: var(--radius-sm);
}

/* Apple Form Controls */
.form-group {
  margin-bottom: var(--spacing-lg);
}

.form-label {
  display: block;
  font-weight: 590;
  font-size: 15px;
  margin-bottom: var(--spacing-sm);
  color: var(--label-primary);
}

.form-control {
  width: 100%;
  padding: 12px var(--spacing-md);
  border: 1px solid var(--separator-primary);
  border-radius: var(--radius-md);
  background: var(--background-primary);
  font-family: inherit;
  font-size: 17px;
  line-height: 1.5;
  color: var(--label-primary);
  transition: all var(--transition-base);
  -webkit-appearance: none;
  appearance: none;
}

.form-control:focus {
  outline: none;
  border-color: var(--system-blue);
  box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.1);
}

.form-control::placeholder {
  color: var(--label-tertiary);
}

select.form-control {
  background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236e6e73' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
  background-position: right 12px center;
  background-repeat: no-repeat;
  background-size: 16px;
  padding-right: 40px;
}

textarea.form-control {
  resize: vertical;
  min-height: 120px;
}

input[type="color"] {
  padding: 8px;
  height: 44px;
  cursor: pointer;
}

input[type="file"] {
  padding: 12px;
  cursor: pointer;
}

input[type="file"]::file-selector-button {
  background: var(--system-blue);
  color: white;
  border: none;
  padding: 6px 12px;
  border-radius: 6px;
  margin-right: 12px;
  font-weight: 590;
  cursor: pointer;
  transition: var(--transition-base);
}

input[type="file"]::file-selector-button:hover {
  background: var(--system-blue-dark);
}

/* Grid System */
.grid {
  display: grid;
  gap: var(--spacing-lg);
}

.grid-cols-1 { grid-template-columns: repeat(1, 1fr); }
.grid-cols-2 { grid-template-columns: repeat(2, 1fr); }
.grid-cols-3 { grid-template-columns: repeat(3, 1fr); }

/* Apple Toggle Switch */
.toggle-group {
  display: flex;
  background: var(--system-gray-light);
  border-radius: var(--radius-sm);
  padding: 2px;
  gap: 2px;
}

.toggle-btn {
  padding: 8px 16px;
  font-size: 14px;
  font-weight: 590;
  border: none;
  border-radius: 6px;
  background: transparent;
  color: var(--label-secondary);
  cursor: pointer;
  transition: all var(--transition-base);
  flex: 1;
}

.toggle-btn.active {
  background: var(--background-primary);
  color: var(--label-primary);
  box-shadow: var(--shadow-sm);
}

/* Design Sidebar (Left) */
.design-sidebar {
  position: fixed;
  top: 0;
  left: -600px;
  width: 600px;
  height: 100vh;
  background: var(--background-primary);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border-right: 1px solid var(--separator-secondary);
  box-shadow: var(--shadow-xl);
  z-index: 1000;
  transition: left var(--transition-slow);
  display: flex;
  flex-direction: column;
}

.design-sidebar.open {
  left: 0;
}

/* Merge Fields Sidebar (Right) */
.merge-fields-sidebar {
  position: fixed;
  top: 0;
  right: -500px;
  width: 500px;
  height: 100vh;
  background: var(--background-primary);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border-left: 1px solid var(--separator-secondary);
  box-shadow: var(--shadow-xl);
  z-index: 1000;
  transition: right var(--transition-slow);
  display: flex;
  flex-direction: column;
}

.merge-fields-sidebar.open {
  right: 0;
}

.sidebar-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(0, 0, 0, 0.4);
  z-index: 999;
  opacity: 0;
  visibility: hidden;
  transition: all var(--transition-base);
  backdrop-filter: blur(4px);
  -webkit-backdrop-filter: blur(4px);
}

.sidebar-overlay.visible {
  opacity: 1;
  visibility: visible;
}

.sidebar-header {
  padding: var(--spacing-lg);
  border-bottom: 1px solid var(--separator-secondary);
  background: var(--background-secondary);
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.sidebar-content {
  flex: 1;
  overflow-y: auto;
  padding: var(--spacing-lg);
}

/* Design Options */
.design-option-group {
  margin-bottom: var(--spacing-xl);
}

.design-option-group h4 {
  font-size: 18px;
  font-weight: 590;
  margin-bottom: var(--spacing-md);
  color: var(--label-primary);
}

.color-scheme-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: var(--spacing-md);
}

.color-scheme-option {
  padding: var(--spacing-md);
  border: 2px solid var(--separator-secondary);
  border-radius: var(--radius-md);
  cursor: pointer;
  transition: all var(--transition-base);
  background: var(--background-primary);
}

.color-scheme-option:hover {
  border-color: var(--system-blue);
  box-shadow: var(--shadow-sm);
}

.color-scheme-option.selected {
  border-color: var(--system-blue);
  background: rgba(0, 122, 255, 0.05);
}

.color-scheme-preview {
  display: flex;
  gap: var(--spacing-xs);
  margin-bottom: var(--spacing-sm);
}

.color-dot {
  width: 16px;
  height: 16px;
  border-radius: 50%;
  border: 1px solid var(--separator-primary);
}

.layout-style-grid {
  display: grid;
  gap: var(--spacing-md);
}

.layout-option {
  padding: var(--spacing-md);
  border: 2px solid var(--separator-secondary);
  border-radius: var(--radius-md);
  cursor: pointer;
  transition: all var(--transition-base);
  background: var(--background-primary);
}

.layout-option:hover {
  border-color: var(--system-blue);
  box-shadow: var(--shadow-sm);
}

.layout-option.selected {
  border-color: var(--system-blue);
  background: rgba(0, 122, 255, 0.05);
}

.button-style-grid {
  display: grid;
  gap: var(--spacing-md);
}

.button-style-option {
  padding: var(--spacing-md);
  border: 2px solid var(--separator-secondary);
  border-radius: var(--radius-md);
  cursor: pointer;
  transition: all var(--transition-base);
  background: var(--background-primary);
  text-align: center;
}

.button-style-option:hover {
  border-color: var(--system-blue);
  box-shadow: var(--shadow-sm);
}

.button-style-option.selected {
  border-color: var(--system-blue);
  background: rgba(0, 122, 255, 0.05);
}

.button-preview {
  padding: 8px 16px;
  border-radius: var(--radius-sm);
  color: white;
  font-size: 14px;
  font-weight: 590;
  margin-bottom: var(--spacing-sm);
  display: inline-block;
}

/* Floating Action Buttons */
.fab {
  position: fixed;
  bottom: var(--spacing-lg);
  width: 56px;
  height: 56px;
  background: linear-gradient(135deg, var(--system-blue) 0%, var(--system-blue-dark) 100%);
  color: white;
  border: none;
  border-radius: 50%;
  box-shadow: var(--shadow-lg);
  cursor: pointer;
  z-index: 998;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
  font-weight: 600;
  transition: all var(--transition-base);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
}

.fab:hover {
  transform: translateY(-2px) scale(1.05);
  box-shadow: var(--shadow-xl);
}

.fab-design {
  left: var(--spacing-lg);
  background: linear-gradient(135deg, var(--system-blue) 0%, var(--system-blue-dark) 100%);
}

.fab-merge {
  right: var(--spacing-lg);
}

/* Offer Blocks */
.offer-block {
  border: 1px solid var(--separator-secondary);
  border-radius: var(--radius-lg);
  background: var(--background-primary);
  margin-bottom: var(--spacing-lg);
  overflow: hidden;
  box-shadow: var(--shadow-sm);
  transition: all var(--transition-base);
}

.offer-block:hover {
  box-shadow: var(--shadow-md);
  transform: translateY(-1px);
}

.offer-header {
  padding: var(--spacing-lg);
  border-bottom: 1px solid var(--separator-secondary);
  background: var(--background-secondary);
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.offer-body {
  padding: var(--spacing-lg);
  display: grid;
  grid-template-columns: 240px 1fr;
  gap: var(--spacing-lg);
  align-items: flex-start;
}

.offer-image-preview {
  width: 240px;
  height: 240px;
  border-radius: var(--radius-md);
  object-fit: cover;
  border: 1px solid var(--separator-secondary);
  box-shadow: var(--shadow-sm);
}

/* Preview Panes */
.preview-container {
  background: var(--system-gray-light);
  border-radius: var(--radius-lg);
  padding: var(--spacing-lg);
  min-height: 70vh;
  display: flex;
  justify-content: center;
  align-items: flex-start;
}

.preview-frame {
  border: none;
  border-radius: var(--radius-md);
  box-shadow: var(--shadow-lg);
  background: white;
  transition: all var(--transition-base);
}

.preview-frame.desktop {
  width: 100%;
  height: 100%;
  max-width: 800px;
}

.preview-frame.mobile {
  width: 375px;
  height: 600px;
}

/* Code Block */
.code-container {
  background: var(--background-secondary);
  border-radius: var(--radius-lg);
  overflow: hidden;
  font-family: var(--font-family-mono);
}

.code-block {
  padding: var(--spacing-lg);
  font-size: 14px;
  line-height: 1.6;
  color: var(--label-primary);
  white-space: pre-wrap;
  word-wrap: break-word;
  max-height: 400px;
  overflow-y: auto;
  margin: 0;
}

/* Loading States */
.spinner {
  width: 20px;
  height: 20px;
  border: 2px solid rgba(255, 255, 255, 0.3);
  border-radius: 50%;
  border-top-color: white;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  to {
    transform: rotate(360deg);
  }
}

/* Accordion */
.accordion-item {
  border: 1px solid var(--separator-secondary);
  border-radius: var(--radius-md);
  margin-bottom: 2px;
  overflow: hidden;
  background: var(--background-primary);
}

.accordion-header {
  padding: var(--spacing-md) var(--spacing-lg);
  background: var(--background-primary);
  border: none;
  width: 100%;
  text-align: left;
  font-family: inherit;
  font-size: 17px;
  font-weight: 590;
  color: var(--label-primary);
  cursor: pointer;
  display: flex;
  justify-content: space-between;
  align-items: center;
  transition: all var(--transition-base);
}

.accordion-header:hover {
  background: var(--background-secondary);
}

.accordion-content {
  max-height: 0;
  overflow: hidden;
  transition: max-height var(--transition-slow);
  border-top: 1px solid var(--separator-secondary);
}

.accordion-content.open {
  max-height: 1000px;
}

.accordion-body {
  padding: var(--spacing-md);
}

/* Merge Field Items */
.merge-field-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px var(--spacing-md);
  border-radius: var(--radius-sm);
  background: var(--background-primary);
  margin-bottom: 2px;
  cursor: pointer;
  transition: all var(--transition-base);
  border: 1px solid transparent;
}

.merge-field-item:hover {
  background: var(--background-secondary);
  border-color: var(--system-blue);
  transform: translateY(-1px);
  box-shadow: var(--shadow-sm);
}

.merge-field-code {
  font-family: var(--font-family-mono);
  font-size: 13px;
  color: var(--system-blue);
  background: rgba(0, 122, 255, 0.08);
  padding: 4px 8px;
  border-radius: var(--radius-xs);
  font-weight: 590;
}

/* Responsive Design */
@media (max-width: 1024px) {
  .grid-cols-2 { grid-template-columns: 1fr; }
  .preview-frame.mobile { width: 320px; height: 500px; }
  .design-sidebar { width: 500px; left: -500px; }
}

@media (max-width: 768px) {
  .container { padding: 0 var(--spacing-md); }
  main { padding: var(--spacing-lg) 0 80px 0; }
  .hero { margin-bottom: var(--spacing-2xl); padding: var(--spacing-2xl) 0; }
  .hero-title { font-size: 2.5rem; }
  .card-header, .card-body { padding: var(--spacing-lg); }
  
  .card-header {
    flex-direction: column;
    gap: var(--spacing-md);
    align-items: flex-start;
  }
  
  .offer-body {
    grid-template-columns: 1fr;
    gap: var(--spacing-md);
  }
  
  .offer-image-preview {
    width: 200px;
    height: 200px;
    margin: 0 auto;
  }
  
  .grid-cols-3 { grid-template-columns: 1fr; }
  .design-sidebar { width: 90vw; left: -90vw; }
  .merge-fields-sidebar { width: 90vw; right: -90vw; }
  .color-scheme-grid { grid-template-columns: 1fr; }
}

/* Utility Classes */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

.hidden { display: none; }
.flex { display: flex; }
.items-center { align-items: center; }
.justify-between { justify-content: space-between; }
.gap-2 { gap: var(--spacing-sm); }
.gap-4 { gap: var(--spacing-md); }
.mb-4 { margin-bottom: var(--spacing-md); }
.mb-6 { margin-bottom: var(--spacing-lg); }
.w-full { width: 100%; }
    </style>
  </head>
  <body>
    <div class="container">
      <main>
        <section class="hero">
          <h1 class="text-6xl hero-title">Craftor</h1>
          <p class="text-lg hero-subtitle">
            Create, customize, and conquer more with HTML-ready designs for you to use.
          </p>
        </section>

        <section class="card mb-6">
          <div class="card-header">
            <h2 class="text-2xl">Customize Your Email Content</h2>
            <button type="button" id="merge-fields-toggle" class="btn btn-ghost btn-sm">
              Insert Merge Fields
            </button>
          </div>
          <div class="card-body">
            <form id="email-form">
              <div class="form-group">
                <label for="photo" class="form-label">Add a Hero Image (optional)</label>
                <input type="file" id="photo" name="photo" accept="image/png, image/jpeg" class="form-control" />
              </div>

              <div class="form-group">
                <label for="email-body" class="form-label">Email Body</label>
                <textarea
                  id="email-body"
                  name="email-body"
                  rows="6"
                  placeholder="e.g., Hi {{recipient.first_name}}, we have some exciting news about your {{customer.last_transaction.vehicle.make}}..."
                  required
                  class="form-control"
                ></textarea>
              </div>

              <div class="grid grid-cols-2">
                <div class="form-group">
                  <label for="body_bg_color" class="form-label">Email Body Background Color</label>
                  <input type="color" id="body_bg_color" name="body_bg_color" value="#ffffff" class="form-control">
                </div>
                <div class="form-group">
                  <label for="cta_color" class="form-label">Main CTA Button Color</label>
                  <input type="color" id="cta_color" name="cta_color" value="#4f46e5" class="form-control">
                </div>
              </div>

              <div class="grid grid-cols-2">
                <div class="form-group">
                  <label for="cta" class="form-label">Main Call to Action Button Text</label>
                  <input
                    type="text"
                    id="cta"
                    name="cta"
                    placeholder="e.g., See Our Specials"
                    class="form-control"
                  />
                </div>
                <div class="form-group">
                  <label for="cta_link" class="form-label">Main Call to Action Button Link</label>
                  <input
                    type="text"
                    id="cta_link"
                    name="cta_link"
                    placeholder="e.g., https://example.com/specials"
                    class="form-control"
                  />
                </div>
              </div>

              <!-- Offers Section -->
              <div style="margin-top: var(--spacing-2xl); padding-top: var(--spacing-xl); border-top: 1px solid var(--separator-secondary);">
                <h3 class="text-2xl mb-4">Promotional Offers (optional, max 5)</h3>
                <div id="offers-container">
                  <!-- Offer 1 -->
                  <div class="offer-block" id="offer-block-1">
                    <div class="offer-header">
                      <h4 class="text-xl">Offer 1</h4>
                    </div>
                    <div class="offer-body">
                      <div style="display: flex; flex-direction: column; gap: var(--spacing-md);">
                        <label class="form-label" style="text-align: center;">Offer Image</label>
                        <img
                          id="offer_image_preview_1"
                          src="https://placehold.co/200x200/f1f3f5/6c757d?text=Image"
                          alt="Offer 1 image preview"
                          class="offer-image-preview"
                        />
                        <input
                          type="file"
                          id="offer_image_1"
                          name="offer_image_1"
                          accept="image/png, image/jpeg"
                          class="form-control"
                        />
                        <div class="form-group">
                          <label for="offer_image_position_1" class="form-label">Image Position</label>
                          <select id="offer_image_position_1" name="offer_image_position_1" class="form-control">
                            <option value="left">Left</option>
                            <option value="right">Right</option>
                            <option value="top">Top</option>
                          </select>
                        </div>
                      </div>
                      <div style="display: flex; flex-direction: column; gap: var(--spacing-md);">
                        <div class="form-group">
                          <label for="offer_vehicle_1" class="form-label">Vehicle / Product</label>
                          <input
                            type="text"
                            id="offer_vehicle_1"
                            name="offer_vehicle_1"
                            placeholder="e.g., 2024 Honda Civic"
                            class="form-control"
                          />
                        </div>
                        <div class="form-group">
                          <label for="offer_title_1" class="form-label">Offer Title</label>
                          <input
                            type="text"
                            id="offer_title_1"
                            name="offer_title_1"
                            placeholder="e.g., Lease for $299/mo"
                            class="form-control"
                          />
                        </div>
                        <div class="form-group">
                          <label for="offer_details_1" class="form-label">Offer Details</label>
                          <textarea
                            id="offer_details_1"
                            name="offer_details_1"
                            rows="3"
                            placeholder="e.g., 36-month lease, $3,000 down."
                            class="form-control"
                          ></textarea>
                        </div>
                        <div class="grid grid-cols-3">
                          <div class="form-group">
                            <label for="offer_cta_text_1" class="form-label">CTA Text</label>
                            <input
                              type="text"
                              id="offer_cta_text_1"
                              name="offer_cta_text_1"
                              placeholder="View Inventory"
                              class="form-control"
                            />
                          </div>
                          <div class="form-group">
                            <label for="offer_cta_link_1" class="form-label">CTA Link</label>
                            <input
                              type="text"
                              id="offer_cta_link_1"
                              name="offer_cta_link_1"
                              placeholder="https://example.com/specials"
                              class="form-control"
                            />
                          </div>
                          <div class="form-group">
                            <label for="offer_cta_color_1" class="form-label">CTA Color</label>
                            <input type="color" id="offer_cta_color_1" name="offer_cta_color_1" value="#4f46e5" class="form-control">
                          </div>
                        </div>
                        <div class="form-group">
                          <label for="offer_disclaimer_1" class="form-label">Disclaimer</label>
                          <textarea
                            id="offer_disclaimer_1"
                            name="offer_disclaimer_1"
                            rows="2"
                            placeholder="e.g., W.A.C. See dealer for details."
                            class="form-control"
                          ></textarea>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <button type="button" id="add-offer-btn" class="btn btn-secondary">
                  Add Another Offer
                </button>
              </div>

              <!-- Footer CTAs Section -->
              <div style="margin-top: var(--spacing-2xl); padding-top: var(--spacing-xl); border-top: 1px solid var(--separator-secondary);">
                <h3 class="text-2xl mb-4">Footer Call to Actions (optional, max 3)</h3>
                <p class="text-lg" style="color: var(--label-secondary); margin-bottom: var(--spacing-lg);">
                  These links will appear at the bottom of the email, useful for secondary actions.
                </p>
                <div class="grid grid-cols-2 mb-6">
                  <div class="form-group">
                    <label for="footer_bg_color" class="form-label">Section Background</label>
                    <input type="color" id="footer_bg_color" name="footer_bg_color" value="#ffffff" class="form-control">
                  </div>
                  <div class="form-group">
                    <label for="footer_cta_text_color" class="form-label">Link Color</label>
                    <input type="color" id="footer_cta_text_color" name="footer_cta_text_color" value="#4f46e5" class="form-control">
                  </div>
                </div>
                <div id="footer-ctas-container">
                  <!-- CTA 1 -->
                  <div class="card mb-4" id="footer-cta-block-1">
                    <div class="card-header">
                      <h4 class="text-lg">Link 1</h4>
                    </div>
                    <div class="card-body">
                      <div class="grid grid-cols-2">
                        <div class="form-group">
                          <label for="footer_cta_text_1" class="form-label">Link Text</label>
                          <input type="text" id="footer_cta_text_1" name="footer_cta_text_1" placeholder="Get In Touch" class="form-control">
                        </div>
                        <div class="form-group">
                          <label for="footer_cta_link_1" class="form-label">Link URL</label>
                          <input type="text" id="footer_cta_link_1" name="footer_cta_link_1" placeholder="{{dealership.tracked_website_homepage_no_lp_url}}" class="form-control">
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <button type="button" id="add-footer-cta-btn" class="btn btn-secondary">Add Another Link</button>
              </div>

              <div class="form-group" style="margin-top: var(--spacing-2xl);">
                <label for="disclaimer" class="form-label">Footer Disclaimer (optional)</label>
                <textarea
                  id="disclaimer"
                  name="disclaimer"
                  rows="4"
                  placeholder="e.g., This is a promotional email. Prices and offers subject to change."
                  class="form-control"
                ></textarea>
              </div>

              <button type="submit" id="generate-btn" class="btn btn-primary w-full" style="margin-top: var(--spacing-xl);">
                <span class="btn-text">Generate Template</span>
                <div class="spinner hidden"></div>
              </button>
            </form>
          </div>
        </section>

        <section class="grid grid-cols-2" id="output-container" style="display: none;">
          <div class="card">
            <div class="card-header">
              <h3 class="text-xl">Preview</h3>
              <div class="toggle-group">
                <button id="desktop-view-btn" class="toggle-btn active" data-view="desktop">Desktop</button>
                <button id="mobile-view-btn" class="toggle-btn" data-view="mobile">Mobile</button>
              </div>
            </div>
            <div class="preview-container">
              <iframe id="preview-pane" title="Email Preview" class="preview-frame desktop"></iframe>
            </div>
          </div>
          
          <div class="card">
            <div class="card-header">
              <h3 class="text-xl">HTML Code</h3>
              <div class="flex gap-2">
                <button id="download-btn" class="btn btn-secondary btn-sm">Download HTML</button>
                <button id="copy-btn" class="btn btn-primary btn-sm">Copy HTML</button>
              </div>
            </div>
            <div class="code-container">
              <pre><code id="code-block" class="code-block"></code></pre>
            </div>
          </div>
        </section>

        <section class="card" id="output-placeholder">
          <div class="card-body" style="text-align: center; padding: var(--spacing-3xl);">
            <p class="text-lg" style="color: var(--label-secondary);">Your generated email will appear here.</p>
          </div>
        </section>

        <footer style="text-align: center; margin-top: var(--spacing-3xl); color: var(--label-secondary);">
          <p class="text-sm">Created by Jayden Wallace © 2025</p>
        </footer>
      </main>
    </div>
    
    <!-- Design Customization Sidebar (Left) -->
    <div id="design-sidebar" class="design-sidebar">
      <div class="sidebar-header">
        <h3 class="text-xl">Design Customization</h3>
        <button type="button" id="close-design-sidebar" class="btn btn-secondary btn-sm" style="width: 32px; height: 32px; padding: 0; border-radius: 50%;">&times;</button>
      </div>
      <div class="sidebar-content">
        <!-- Font Selection -->
        <div class="design-option-group">
          <h4>Email Font</h4>
          <select id="design-font-family" name="design-font-family" class="form-control">
            <option value="'Arial', sans-serif">Arial</option>
            <option value="'Courier New', Courier, monospace">Courier New</option>
            <option value="'Georgia', serif">Georgia</option>
            <option value="'Helvetica', sans-serif">Helvetica</option>
            <option value="'Lucida Sans', 'Lucida Sans Unicode', 'Lucida Grande', sans-serif">Lucida Sans</option>
            <option value="'Tahoma', sans-serif">Tahoma</option>
            <option value="'Times New Roman', Times, serif">Times New Roman</option>
            <option value="'Trebuchet MS', 'Helvetica', sans-serif">Trebuchet MS</option>
            <option value="'Verdana', sans-serif">Verdana</option>
          </select>
        </div>

        <!-- Color Schemes -->
        <div class="design-option-group">
          <h4>Color Schemes</h4>
          <div class="color-scheme-grid">
            <div class="color-scheme-option selected" data-scheme="modern">
              <div class="color-scheme-preview">
                <div class="color-dot" style="background: #007aff;"></div>
                <div class="color-dot" style="background: #ffffff;"></div>
                <div class="color-dot" style="background: #f5f5f7;"></div>
                <div class="color-dot" style="background: #1d1d1f;"></div>
              </div>
              <div class="text-sm" style="font-weight: 590;">Modern Blue</div>
              <div class="text-xs" style="color: var(--label-secondary);">Clean and professional</div>
            </div>
            
            <div class="color-scheme-option" data-scheme="warm">
              <div class="color-scheme-preview">
                <div class="color-dot" style="background: #ff6b35;"></div>
                <div class="color-dot" style="background: #fff8f5;"></div>
                <div class="color-dot" style="background: #ffeee6;"></div>
                <div class="color-dot" style="background: #2d1810;"></div>
              </div>
              <div class="text-sm" style="font-weight: 590;">Warm Orange</div>
              <div class="text-xs" style="color: var(--label-secondary);">Friendly and inviting</div>
            </div>
            
            <div class="color-scheme-option" data-scheme="elegant">
              <div class="color-scheme-preview">
                <div class="color-dot" style="background: #6366f1;"></div>
                <div class="color-dot" style="background: #fafafa;"></div>
                <div class="color-dot" style="background: #f8fafc;"></div>
                <div class="color-dot" style="background: #1e293b;"></div>
              </div>
              <div class="text-sm" style="font-weight: 590;">Elegant Purple</div>
              <div class="text-xs" style="color: var(--label-secondary);">Sophisticated and refined</div>
            </div>
            
            <div class="color-scheme-option" data-scheme="nature">
              <div class="color-scheme-preview">
                <div class="color-dot" style="background: #10b981;"></div>
                <div class="color-dot" style="background: #f0fdf4;"></div>
                <div class="color-dot" style="background: #ecfdf5;"></div>
                <div class="color-dot" style="background: #14532d;"></div>
              </div>
              <div class="text-sm" style="font-weight: 590;">Nature Green</div>
              <div class="text-xs" style="color: var(--label-secondary);">Fresh and natural</div>
            </div>
            
            <div class="color-scheme-option" data-scheme="corporate">
              <div class="color-scheme-preview">
                <div class="color-dot" style="background: #374151;"></div>
                <div class="color-dot" style="background: #ffffff;"></div>
                <div class="color-dot" style="background: #f9fafb;"></div>
                <div class="color-dot" style="background: #111827;"></div>
              </div>
              <div class="text-sm" style="font-weight: 590;">Corporate Gray</div>
              <div class="text-xs" style="color: var(--label-secondary);">Professional and trustworthy</div>
            </div>
            
            <div class="color-scheme-option" data-scheme="vibrant">
              <div class="color-scheme-preview">
                <div class="color-dot" style="background: #ec4899;"></div>
                <div class="color-dot" style="background: #fdf2f8;"></div>
                <div class="color-dot" style="background: #fce7f3;"></div>
                <div class="color-dot" style="background: #831843;"></div>
              </div>
              <div class="text-sm" style="font-weight: 590;">Vibrant Pink</div>
              <div class="text-xs" style="color: var(--label-secondary);">Bold and energetic</div>
            </div>
          </div>
        </div>

        <!-- Layout Styles -->
        <div class="design-option-group">
          <h4>Layout Styles</h4>
          <div class="layout-style-grid">
            <div class="layout-option selected" data-layout="centered">
              <div class="text-sm" style="font-weight: 590; margin-bottom: 4px;">Centered Layout</div>
              <div class="text-xs" style="color: var(--label-secondary);">Traditional centered content with equal margins</div>
            </div>
            
            <div class="layout-option" data-layout="full-width">
              <div class="text-sm" style="font-weight: 590; margin-bottom: 4px;">Full Width Layout</div>
              <div class="text-xs" style="color: var(--label-secondary);">Content spans the full width with edge-to-edge design</div>
            </div>
            
            <div class="layout-option" data-layout="card-style">
              <div class="text-sm" style="font-weight: 590; margin-bottom: 4px;">Card Style Layout</div>
              <div class="text-xs" style="color: var(--label-secondary);">Modern card-based layout with rounded corners</div>
            </div>
            
            <div class="layout-option" data-layout="minimal">
              <div class="text-sm" style="font-weight: 590; margin-bottom: 4px;">Minimal Layout</div>
              <div class="text-xs" style="color: var(--label-secondary);">Clean and spacious with lots of white space</div>
            </div>
          </div>
        </div>

        <!-- Button Styles -->
        <div class="design-option-group">
          <h4>Button Styles</h4>
          <div class="button-style-grid">
            <div class="button-style-option selected" data-button="rounded">
              <div class="button-preview" style="background: #007aff; border-radius: 8px;">Rounded Button</div>
              <div class="text-xs" style="color: var(--label-secondary);">Modern rounded corners</div>
            </div>
            
            <div class="button-style-option" data-button="pill">
              <div class="button-preview" style="background: #007aff; border-radius: 20px;">Pill Button</div>
              <div class="text-xs" style="color: var(--label-secondary);">Fully rounded pill shape</div>
            </div>
            
            <div class="button-style-option" data-button="square">
              <div class="button-preview" style="background: #007aff; border-radius: 0px;">Square Button</div>
              <div class="text-xs" style="color: var(--label-secondary);">Classic square edges</div>
            </div>
            
            <div class="button-style-option" data-button="outlined">
              <div class="button-preview" style="background: transparent; border: 2px solid #007aff; color: #007aff; border-radius: 8px;">Outlined Button</div>
              <div class="text-xs" style="color: var(--label-secondary);">Outline style with border</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Merge Fields Sidebar (Right) -->
    <div id="merge-fields-sidebar" class="merge-fields-sidebar">
      <div class="sidebar-header">
        <h3 class="text-xl">Insert Merge Field</h3>
        <button type="button" id="close-sidebar" class="btn btn-secondary btn-sm" style="width: 32px; height: 32px; padding: 0; border-radius: 50%;">&times;</button>
      </div>
      <div class="sidebar-content">
        <div class="accordion-item">
          <button type="button" class="accordion-header">
            Recipient & Dealer
            <span style="transform: rotate(0deg); transition: transform var(--transition-base);">▼</span>
          </button>
          <div class="accordion-content">
            <div class="accordion-body">
              <div class="merge-field-item" data-value="{{recipient.first_name}}">
                <span>Recipient First Name</span>
                <code class="merge-field-code">{{recipient.first_name}}</code>
              </div>
              <div class="merge-field-item" data-value="{{dealership.name}}">
                <span>Dealership Name</span>
                <code class="merge-field-code">{{dealership.name}}</code>
              </div>
              <div class="merge-field-item" data-value="{{dealership.phone_number}}">
                <span>Dealership Phone</span>
                <code class="merge-field-code">{{dealership.phone_number}}</code>
              </div>
              <div class="merge-field-item" data-value="{{dealership.address}}">
                <span>Dealership Address</span>
                <code class="merge-field-code">{{dealership.address}}</code>
              </div>
            </div>
          </div>
        </div>

        <div class="accordion-item">
          <button type="button" class="accordion-header">
            Customer Vehicle & Transaction
            <span style="transform: rotate(0deg); transition: transform var(--transition-base);">▼</span>
          </button>
          <div class="accordion-content">
            <div class="accordion-body">
              <div class="merge-field-item" data-value="{{customer.last_transaction.vehicle.year}}">
                <span>Vehicle Year</span>
                <code class="merge-field-code">{{customer.last_transaction.vehicle.year}}</code>
              </div>
              <div class="merge-field-item" data-value="{{customer.last_transaction.vehicle.make}}">
                <span>Vehicle Make</span>
                <code class="merge-field-code">{{customer.last_transaction.vehicle.make}}</code>
              </div>
              <div class="merge-field-item" data-value="{{customer.last_transaction.vehicle.model}}">
                <span>Vehicle Model</span>
                <code class="merge-field-code">{{customer.last_transaction.vehicle.model}}</code>
              </div>
            </div>
          </div>
        </div>

        <div class="accordion-item">
          <button type="button" class="accordion-header">
            Website Links
            <span style="transform: rotate(0deg); transition: transform var(--transition-base);">▼</span>
          </button>
          <div class="accordion-content">
            <div class="accordion-body">
              <div class="merge-field-item" data-value="{{dealership.tracked_website_homepage_no_lp_url}}">
                <span>Tracked Homepage (No LP)</span>
                <code class="merge-field-code">{{dealership.tracked_website_homepage_no_lp_url}}</code>
              </div>
              <div class="merge-field-item" data-value="{{dealership.tracked_website_service_no_lp_url}}">
                <span>Tracked Service (No LP)</span>
                <code class="merge-field-code">{{dealership.tracked_website_service_no_lp_url}}</code>
              </div>
              <div class="merge-field-item" data-value="{{dealership.website_homepage_url}}">
                <span>Homepage URL</span>
                <code class="merge-field-code">{{dealership.website_homepage_url}}</code>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div id="sidebar-overlay" class="sidebar-overlay"></div>
    
    <!-- Floating Action Buttons -->
    <button type="button" id="floating-design-btn" class="fab fab-design" title="Design Customization">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M12 20h9"></path>
        <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"></path>
      </svg>
    </button>
    
    <button type="button" id="floating-merge-btn" class="fab fab-merge" title="Insert Merge Fields">
      <span style="font-family: var(--font-family-mono); font-size: 16px; font-weight: bold;">{{}}</span>
    </button>

    <script>
      // Design and visual customization settings
      const designSettings = {
        fontFamily: "'Arial', sans-serif",
        colorScheme: 'modern',
        layoutStyle: 'centered',
        buttonStyle: 'rounded'
      };

      // Basic functionality for demo
      const emailForm = document.getElementById('email-form');
      const generateBtn = document.getElementById('generate-btn');
      const outputContainer = document.getElementById('output-container');
      const outputPlaceholder = document.getElementById('output-placeholder');
      
      // Sidebar elements
      const designSidebar = document.getElementById('design-sidebar');
      const mergeFieldsSidebar = document.getElementById('merge-fields-sidebar');
      const sidebarOverlay = document.getElementById('sidebar-overlay');
      
      // Toggle buttons
      const designToggle = document.getElementById('floating-design-btn');
      const mergeFieldsToggle = document.getElementById('merge-fields-toggle');
      const floatingMergeBtn = document.getElementById('floating-merge-btn');
      
      // Close buttons
      const closeDesignSidebar = document.getElementById('close-design-sidebar');
      const closeMergeSidebar = document.getElementById('close-sidebar');

      // Design Sidebar functionality
      const openDesignSidebar = () => {
        designSidebar.classList.add('open');
        mergeFieldsSidebar.classList.remove('open');
        sidebarOverlay.classList.add('visible');
        document.body.style.overflow = 'hidden';
      };

      const closeSidebarFunc = () => {
        designSidebar.classList.remove('open');
        mergeFieldsSidebar.classList.remove('open');
        sidebarOverlay.classList.remove('visible');
        document.body.style.overflow = '';
      };

      // Merge Fields Sidebar functionality
      const openMergeSidebar = () => {
        mergeFieldsSidebar.classList.add('open');
        designSidebar.classList.remove('open');
        sidebarOverlay.classList.add('visible');
        document.body.style.overflow = 'hidden';
      };

      // Event listeners for sidebar toggles
      designToggle.addEventListener('click', openDesignSidebar);
      mergeFieldsToggle.addEventListener('click', openMergeSidebar);
      floatingMergeBtn.addEventListener('click', openMergeSidebar);
      closeDesignSidebar.addEventListener('click', closeSidebarFunc);
      closeMergeSidebar.addEventListener('click', closeSidebarFunc);
      sidebarOverlay.addEventListener('click', closeSidebarFunc);

      // Design option handlers
      document.getElementById('design-font-family').addEventListener('change', (e) => {
        designSettings.fontFamily = e.target.value;
        console.log('Font updated:', designSettings.fontFamily);
      });

      // Color scheme selection
      document.querySelectorAll('.color-scheme-option').forEach(option => {
        option.addEventListener('click', () => {
          document.querySelectorAll('.color-scheme-option').forEach(o => o.classList.remove('selected'));
          option.classList.add('selected');
          designSettings.colorScheme = option.dataset.scheme;
          console.log('Color scheme updated:', designSettings.colorScheme);
        });
      });

      // Layout style selection
      document.querySelectorAll('.layout-option').forEach(option => {
        option.addEventListener('click', () => {
          document.querySelectorAll('.layout-option').forEach(o => o.classList.remove('selected'));
          option.classList.add('selected');
          designSettings.layoutStyle = option.dataset.layout;
          console.log('Layout updated:', designSettings.layoutStyle);
        });
      });

      // Button style selection
      document.querySelectorAll('.button-style-option').forEach(option => {
        option.addEventListener('click', () => {
          document.querySelectorAll('.button-style-option').forEach(o => o.classList.remove('selected'));
          option.classList.add('selected');
          designSettings.buttonStyle = option.dataset.button;
          console.log('Button style updated:', designSettings.buttonStyle);
        });
      });

      // Accordion functionality
      document.querySelectorAll('.accordion-header').forEach(header => {
        header.addEventListener('click', () => {
          const content = header.nextElementSibling;
          const icon = header.querySelector('span');
          const isOpen = content.classList.contains('open');

          // Close all other accordions
          document.querySelectorAll('.accordion-content').forEach(c => {
            c.classList.remove('open');
          });
          document.querySelectorAll('.accordion-header span').forEach(i => {
            i.style.transform = 'rotate(0deg)';
          });

          // Toggle current accordion
          if (!isOpen) {
            content.classList.add('open');
            icon.style.transform = 'rotate(180deg)';
          }
        });
      });

      // Form submission with design settings
      emailForm.addEventListener('submit', (e) => {
        e.preventDefault();
        
        // Show loading state
        const btnText = generateBtn.querySelector('.btn-text');
        const spinner = generateBtn.querySelector('.spinner');
        
        generateBtn.disabled = true;
        btnText.style.display = 'none';
        spinner.classList.remove('hidden');
        
        // Simulate generation with design settings
        setTimeout(() => {
          outputPlaceholder.style.display = 'none';
          outputContainer.style.display = 'grid';
          
          // Reset button
          generateBtn.disabled = false;
          btnText.style.display = 'block';
          spinner.classList.add('hidden');
          
          // Demo content incorporating design settings
          const codeBlock = document.getElementById('code-block');
          const previewPane = document.getElementById('preview-pane');
          
          const schemeColors = {
            modern: { primary: '#007aff', bg: '#ffffff', text: '#1d1d1f' },
            warm: { primary: '#ff6b35', bg: '#fff8f5', text: '#2d1810' },
            elegant: { primary: '#6366f1', bg: '#fafafa', text: '#1e293b' },
            nature: { primary: '#10b981', bg: '#f0fdf4', text: '#14532d' },
            corporate: { primary: '#374151', bg: '#ffffff', text: '#111827' },
            vibrant: { primary: '#ec4899', bg: '#fdf2f8', text: '#831843' }
          };
          
          const colors = schemeColors[designSettings.colorScheme];
          const borderRadius = designSettings.buttonStyle === 'pill' ? '25px' : 
                              designSettings.buttonStyle === 'square' ? '0px' : '8px';
          
          const demoHTML = `<!DOCTYPE html>
<html>
<head>
  <title>Demo Email</title>
</head>
<body style="font-family: ${designSettings.fontFamily}; margin: 0; padding: 20px; background: ${colors.bg};">
  <div style="max-width: 600px; margin: 0 auto; background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
    <div style="padding: 40px 20px; text-align: center;">
      <h1 style="color: ${colors.text}; margin: 0 0 16px 0;">Demo Email Template</h1>
      <p style="color: #86868b; margin: 0 0 24px 0;">Generated with ${designSettings.colorScheme} color scheme and ${designSettings.layoutStyle} layout.</p>
      <a href="#" style="background: ${colors.primary}; color: white; padding: 12px 24px; text-decoration: none; border-radius: ${borderRadius}; font-weight: 600; display: inline-block;">Sample Button</a>
    </div>
  </div>
</body>
</html>`;
          
          codeBlock.textContent = demoHTML;
          previewPane.srcdoc = demoHTML;
          
          // Log current design settings
          console.log('Generated with settings:', designSettings);
        }, 2000);
      });

      // View toggle functionality
      const desktopBtn = document.getElementById('desktop-view-btn');
      const mobileBtn = document.getElementById('mobile-view-btn');
      const previewPane = document.getElementById('preview-pane');

      desktopBtn.addEventListener('click', () => {
        desktopBtn.classList.add('active');
        mobileBtn.classList.remove('active');
        previewPane.className = 'preview-frame desktop';
      });

      mobileBtn.addEventListener('click', () => {
        mobileBtn.classList.add('active');
        desktopBtn.classList.remove('active');
        previewPane.className = 'preview-frame mobile';
      });

      // Copy functionality
      document.getElementById('copy-btn').addEventListener('click', async () => {
        const codeBlock = document.getElementById('code-block');
        const copyBtn = document.getElementById('copy-btn');
        
        try {
          await navigator.clipboard.writeText(codeBlock.textContent);
          const originalText = copyBtn.textContent;
          copyBtn.textContent = 'Copied!';
          setTimeout(() => {
            copyBtn.textContent = originalText;
          }, 2000);
        } catch (err) {
          console.error('Failed to copy:', err);
        }
      });

      // Merge field insertion
      let lastFocusedInput = null;
      
      document.querySelectorAll('input[type="text"], textarea').forEach(input => {
        input.addEventListener('focus', () => {
          lastFocusedInput = input;
        });
      });

      document.querySelectorAll('.merge-field-item').forEach(item => {
        item.addEventListener('click', () => {
          const value = item.dataset.value;
          if (value && lastFocusedInput) {
            const start = lastFocusedInput.selectionStart;
            const end = lastFocusedInput.selectionEnd;
            const text = lastFocusedInput.value;
            
            lastFocusedInput.value = text.substring(0, start) + value + text.substring(end);
            lastFocusedInput.focus();
            lastFocusedInput.setSelectionRange(start + value.length, start + value.length);
            
            closeSidebarFunc();
          }
        });
      });

      // Close sidebars on escape key
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          closeSidebarFunc();
        }
      });
    </script>
  </body>
</html>
